<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>100 Paisanos — Panel (lista)</title>
<style>
:root{
  --bg:#0f1b2b;
  --panel:#12243a;
  --chip:#19304d;
  --ok:#32c08b;
  --bad:#ff4d4f;
  --text:#eaf1ff;
  --muted:#a8bfdc;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial}
.wrap{display:grid;grid-template-columns:320px 1fr;gap:16px;min-height:100%}
@media (max-width: 980px){.wrap{grid-template-columns:1fr}}
/* Panel izq */
.panel{background:var(--panel);border:1px solid #1e3a5f;border-radius:14px;padding:14px}
.panel h3{margin:0 0 8px;font-weight:800;font-size:18px;color:#cfe6ff}
.row{display:flex;gap:8px;align-items:center;margin:8px 0}
.row input[type="text"], .row input[type="number"], .row select{
  width:100%;padding:8px 10px;border-radius:10px;border:1px solid #345b85;background:#0e223a;color:#eaf1ff;outline:none
}
.btn{padding:8px 12px;border-radius:10px;border:1px solid #355c88;background:#113055;color:#eaf1ff;cursor:pointer}
.btn:disabled{opacity:.6;cursor:not-allowed}
.btn.ok{border-color:#2a8b68;background:#0f2b24}
.btn.bad{border-color:#8a2f33;background:#2a0d0f}
.small{font-size:12px;color:var(--muted)}
/* Tablero */
.board{background:#0b1627;border:1px solid #173355;border-radius:14px;padding:16px;display:flex;flex-direction:column;gap:14px}
.header{display:grid;grid-template-columns:1fr auto 1fr;align-items:center;gap:12px}
.team{display:flex;gap:10px;align-items:center;justify-content:flex-start}
.team.right{justify-content:flex-end}
.team input{background:transparent;border:none;color:#fff;font-weight:800;font-size:18px;outline:none;text-align:left}
.team.right input{text-align:right}
.score{background:#102a48;border:1px solid #2d507d;border-radius:10px;padding:4px 10px;font-weight:900}
.title{text-align:center}
.title h1{margin:0;font-size:28px;letter-spacing:.2px}
.title .chip{display:inline-block;margin-top:6px;background:var(--chip);border:1px solid #294c78;border-radius:999px;padding:6px 10px}
/* Respuestas en LISTA */
.answers{display:flex;flex-direction:column;gap:10px;list-style:none;margin:0;padding:0}
.answer{display:flex;gap:10px;align-items:center;justify-content:space-between;border:1px solid #1b3a61;background:linear-gradient(180deg,#0e223a,#0a1626);border-radius:12px;padding:10px 12px;min-height:50px}
.answer .left{display:flex;gap:10px;align-items:center}
.badge{width:34px;height:34px;border-radius:8px;background:#112a47;border:1px solid #2a4e7a;display:grid;place-items:center;font-weight:800}
.answer .pts{font-weight:900}
.strikes{display:flex;gap:10px;justify-content:center}
.x{width:44px;height:44px;border-radius:10px;background:#2a0d0f;border:1px solid #8a2f33;display:grid;place-items:center;font-size:22px;font-weight:900;opacity:.35}
.x.on{opacity:1}
.footer{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
.notice{font-size:12px;color:#9eb7d6;text-align:center}
.hidden .txt{filter:blur(6px);opacity:.6}
.hidden .pts{visibility:hidden}
</style>
</head>
<body>
<div class="wrap">
  <aside class="panel">
    <h3>Panel del Conductor</h3>
    <div class="row"><label class="small">Sesión</label>
      <select id="selSesion">
        <option value="duelo">1) Duelo</option>
        <option value="ronda">2) Ronda</option>
        <option value="robo">3) Robo</option>
      </select>
    </div>
    <div class="row"><label class="small">Multiplicador</label>
      <select id="selMult">
        <option>x1</option><option>x2</option><option>x3</option><option>x4</option>
      </select>
    </div>
    <div class="row"><label class="small">Pregunta #</label>
      <select id="selPregunta"></select>
    </div>
    <div class="row"><label class="small">Respuesta del equipo activo</label></div>
    <div class="row">
      <input id="txtRespuesta" type="text" placeholder="Escribe la respuesta del equipo" />
      <button id="btnValidar" class="btn ok">Validar</button>
    </div>
    <div class="row">
      <button id="btnRevelar" class="btn">Revelar todas</button>
      <button id="btnNueva" class="btn">Nueva ronda</button>
    </div>
    <div class="row">
      <button id="btnStrike" class="btn bad">Strike</button>
      <button id="btnBorrar" class="btn">Borrar puntos</button>
    </div>
    <p class="notice">Sugerencia: elige pregunta, luego la sesión y el equipo activo. Usa “Validar” para registrar la respuesta.</p>
  </aside>

  <main class="board">
    <div class="header">
      <div class="team"><input id="teamA" value="Equipo A" /></div>
      <div class="title">
        <h1 id="pregunta">Cargando pregunta…</h1>
        <div class="chip">Puntos ronda: <b id="puntosRonda">0</b></div>
      </div>
      <div class="team right"><input id="teamB" value="Equipo B" /></div>
    </div>

    <ul class="answers" id="answers"></ul>

    <div class="strikes">
      <div class="x" id="x1">X</div>
      <div class="x" id="x2">X</div>
      <div class="x" id="x3">X</div>
    </div>

    <div class="footer">
      <div class="chip">Sesión: <span id="sesionView">—</span></div>
      <div class="chip">Multiplicador: <span id="multView">x1</span></div>
    </div>
  </main>
</div>

<script>
let DATA=[];           // preguntas.json
let qIndex=0;          // índice de pregunta
let revealed=false;    // mostrar todo
let strikes=0;         // X activas
let roundPoints=0;     // puntos acumulados de la ronda
let multiplier=1;      // multiplicador de ronda

const $ = s => document.querySelector(s);

async function loadData(){
  const r = await fetch('preguntas.json');
  DATA = await r.json();
  // llenar selector
  $("#selPregunta").innerHTML = DATA.map((q,i)=>`<option value="${i}">${i+1}. ${q.pregunta}</option>`).join("");
  $("#selPregunta").value = qIndex;
  setQuestion(qIndex);
}

function setQuestion(i){
  qIndex = +i;
  const q = DATA[qIndex];
  $("#pregunta").textContent = q.pregunta;
  $("#sesionView").textContent = $("#selSesion").selectedOptions[0].textContent.split(') ')[1];
  $("#answers").innerHTML = q.respuestas.map((r,idx)=>`
    <li class="answer hidden" data-pts="${r.puntos}" data-text="${r.texto.toLowerCase()}">
      <div class="left">
        <span class="badge">${idx+1}</span>
        <span class="txt">${r.texto}</span>
      </div>
      <span class="pts">${r.puntos}</span>
    </li>`).join("");
  revealed=false; strikes=0; roundPoints=0; updateUI();
}

function updateUI(){
  $("#puntosRonda").textContent = roundPoints;
  [1,2,3].forEach(n=>$("#x"+n).classList.toggle("on", n<=strikes));
  $("#multView").textContent = "x"+multiplier;
}

// --- validación muy simple (exacta + acentos/espacios) ---
function norm(s){ return (s||"").toLowerCase().normalize("NFD").replace(/[^\w\s]/g,"").replace(/\s+/g," ").trim() }
function validar(){
  const ans = norm($("#txtRespuesta").value);
  if(!ans) return;
  const li = Array.from(document.querySelectorAll("#answers .answer"))
    .find(el=> norm(el.dataset.text) === ans);
  if(li && li.classList.contains("hidden")){
    li.classList.remove("hidden");
    const pts = +li.dataset.pts;
    roundPoints += pts * multiplier;
    updateUI();
  }else{
    strike();
  }
  $("#txtRespuesta").value="";
}
function strike(){ strikes = Math.min(3, strikes+1); updateUI(); }
function revelarTodo(){
  document.querySelectorAll("#answers .answer").forEach(el=>el.classList.remove("hidden"));
}
function nuevaRonda(){
  roundPoints=0; strikes=0; revealed=false; updateUI();
  setQuestion(qIndex);
}

document.addEventListener("DOMContentLoaded",()=>{
  loadData();
  $("#selPregunta").addEventListener("change", e=>setQuestion(e.target.value));
  $("#selSesion").addEventListener("change", e=>$("#sesionView").textContent = e.target.selectedOptions[0].textContent.split(') ')[1]);
  $("#selMult").addEventListener("change", e=>{ multiplier = +e.target.value.replace("x",""); updateUI(); });

  $("#btnValidar").addEventListener("click", validar);
  $("#btnStrike").addEventListener("click", strike);
  $("#btnRevelar").addEventListener("click", revelarTodo);
  $("#btnNueva").addEventListener("click", nuevaRonda);
  $("#btnBorrar").addEventListener("click", ()=>{ roundPoints=0; updateUI(); });
});
</script>
</body>
</html>
